{
  "vendor": "Microsoft",
  "product": "Microsoft Defender for Endpoint",
  "severity": "High",
  "category": "Credential Access",
  "alert_name": "LSASS Memory Dump Using comsvcs.dll MiniDump",
  "description": "The comsvcs.dll library was abused to dump LSASS (Local Security Authority Subsystem Service) process memory on domain controller DC04.company.local (10.10.10.24) at 2024-11-10 12:47:19 UTC. The command 'rundll32.exe C:\\Windows\\System32\\comsvcs.dll,MiniDump 644 C:\\Windows\\Temp\\lsass.dmp full' was executed to create a memory dump of the LSASS process (PID 644) containing plaintext passwords, NTLM hashes, and Kerberos tickets for all logged-in domain users. This technique leverages the legitimate Windows MiniDump function within comsvcs.dll to bypass security controls. The 47MB dump file was created in C:\\Windows\\Temp\\ and subsequently copied to network share \\\\ATTACKER-SERVER\\exfil\\ at 12:49 UTC. Analysis shows 23 domain accounts compromised including 3 Domain Admin credentials. The attack was executed by user account svc_patching@company.local which showed signs of compromise through password spray attack 2 hours earlier. This represents critical credential theft with domain-wide impact.",
  "host_name": "DC04.company.local",
  "host_ip": [
    168430100
  ],
  "host_os": "AGENT_OS_WINDOWS",
  "user_name": [
    "svc_patching@company.local"
  ],
  "account_id": "S-1-5-21-3623811015-3361044348-30300820-6721",
  "domain": "company.local",
  "cgo_name": [
    "rundll32.exe"
  ],
  "cgo_cmd": [
    "rundll32.exe C:\\Windows\\System32\\comsvcs.dll,MiniDump 644 C:\\Windows\\Temp\\lsass.dmp full"
  ],
  "cgo_path": [
    "C:\\Windows\\System32\\rundll32.exe"
  ],
  "os_parent_name": [
    "cmd.exe"
  ],
  "os_parent_cmd": [
    "cmd.exe /c rundll32.exe comsvcs.dll,MiniDump 644 lsass.dmp full"
  ],
  "os_parent_pid": [
    3892
  ],
  "file_name": [
    "lsass.dmp",
    "comsvcs.dll"
  ],
  "file_path": [
    "C:\\Windows\\Temp\\lsass.dmp",
    "C:\\Windows\\System32\\comsvcs.dll"
  ],
  "filesize": "49283584",
  "threat_name": "LSASS Memory Dump",
  "attack_mode": "Credential Access",
  "verdict": "Malicious",
  "risk_score": "95",
  "risk_rating": "Critical",
  "host_risk_level": "Critical",
  "policy_type": "Endpoint Protection",
  "policy_description": "LSASS memory dumping via comsvcs.dll - credential theft",
  "policy_severity": "Critical",
  "policy_recommendation": "Isolate domain controller immediately, force domain-wide password reset, investigate svc_patching compromise, delete dump file, block network share access, enable LSA protection",
  "log_source": "Windows Security Event Log",
  "event_id": "4688",
  "external_link": "https://security.microsoft.com/machines",
  "mitre_att&ck_tactic": "TA0006 - Credential Access",
  "mitre_att&ck_technique": "T1003.001 - OS Credential Dumping: LSASS Memory"
}