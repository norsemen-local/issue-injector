{
  "vendor": "Palo Alto Networks",
  "product": "Cortex XDR Agent",
  "severity": "High",
  "category": "Credential Access",
  "alert_name": "Process Memory Dump Using dd Utility",
  "description": "A suspicious dd utility command was executed on container prod-api-7f9c8d-xk2m4 in Kubernetes cluster prod-eks-01 at 2024-11-13 02:34:17 UTC to dump process memory from /proc filesystem. The command 'dd if=/proc/1247/mem of=/tmp/process_memory.dump bs=1M' was executed to copy the memory contents of process ID 1247 (nginx) to a file. This technique is commonly used by attackers to extract credentials, encryption keys, and sensitive data from application memory. The dd utility provides direct access to kernel memory spaces through the /proc filesystem, bypassing normal security controls. The dumped memory file (47MB) was subsequently exfiltrated via netcat to external IP 185.244.214.123. The container is running with elevated privileges (SYS_PTRACE capability) which enables memory access. This activity was initiated by user account service_monitor which has no legitimate need for memory dumping operations.",
  "cloud_provider": [
    "AWS"
  ],
  "cloud_service_name": "Amazon EKS",
  "cloud_resource_type": [
    "Kubernetes Pod"
  ],
  "container_name": [
    "prod-api-7f9c8d-xk2m4"
  ],
  "container_id": [
    "sha256:7a2b4c6d8e0f1a3b5c7d9e1f3a5b7c9d1e3f5a7b9c1d3e5f7a9b1c3d5e7f9a1b"
  ],
  "cluster_name": [
    "prod-eks-cluster-01"
  ],
  "namespace": [
    "production"
  ],
  "image_name": [
    "company/api-service:v3.2.1"
  ],
  "host_name": "ip-10-40-30-92.ec2.internal",
  "host_ip": [
    169015452
  ],
  "host_os": "AGENT_OS_LINUX",
  "user_name": [
    "service_monitor"
  ],
  "cgo_name": [
    "dd"
  ],
  "cgo_cmd": [
    "dd if=/proc/1247/mem of=/tmp/process_memory.dump bs=1M"
  ],
  "cgo_path": [
    "/usr/bin/dd"
  ],
  "os_parent_name": [
    "bash"
  ],
  "os_parent_cmd": [
    "bash -c dd if=/proc/1247/mem of=/tmp/process_memory.dump bs=1M"
  ],
  "file_name": [
    "process_memory.dump"
  ],
  "file_path": [
    "/tmp/process_memory.dump"
  ],
  "filesize": "49283072",
  "remote_ip": [
    3117405563
  ],
  "remote_port": [
    9999
  ],
  "threat_name": "Memory Credential Dumping",
  "attack_mode": "Credential Access",
  "verdict": "Malicious",
  "risk_score": "89",
  "risk_rating": "High",
  "policy_type": "Container Security Policy",
  "policy_description": "Unauthorized process memory dump in container",
  "policy_severity": "High",
  "policy_recommendation": "Terminate container immediately, remove SYS_PTRACE capability from pod security policy, investigate service_monitor account compromise, block C2 IP address",
  "log_source": "Cortex XDR Agent",
  "detection_url": "https://xdr.paloaltonetworks.com/incidents",
  "mitre_att&ck_tactic": "TA0006 - Credential Access",
  "mitre_att&ck_technique": "T1003.007 - OS Credential Dumping: Proc Filesystem"
}